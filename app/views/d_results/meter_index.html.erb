<%#= javascript_include_tag "tablefix" %>
<script> 
$(function() {
//$('.end_meter').tablefix({width: 450, height: 150, fixRows: 2, fixCols: 1});
	
//$('.tablefix1').tablefix({width: 350, height: 200, fixRows: 1, fixCols: 1});
});
</script>
<%= form_tag({:action => 'd_result_meter_create' }, { :remote => true }) do %>

<div style="float: left;width: 59%;">
<table id='rounded-corner' class="end_meter" width="1500">
  <tr>
  	<th colspan="2">油種</th>
  	<% @m_oils.each do |m_oil| %>
  	  <th colspan="6"><%= m_oil.oil_name %></th>
  	<% end %>
  </tr>
  <tr>
  	<td rowspan="<%= @old_meters.size + 1%>">開<br/>始<br/>時<br/>メ<br/>|<br/>タ<br/>|</td>
  	<td>No</td>
  	<% @m_oils.each do |m_oil| %>
  	  <% @m_codes.each do |m_code| %>
  	    <th>計量</th>
  	    <th><%= m_code.code_name %></th>
  	  <% end %> 	
  	<% end %>
  </tr>
  <% @old_meters.each_with_index do |meter, idx| %>
    <tr>
      <td><%= idx + 1 %></td>	
  	  <% @m_oils.each do |m_oil| %>
  	    <% @m_codes.each do |m_code| %>
  	      <% if meter["#{m_oil.id}_#{m_code.id}_m_meter_id"].blank? %>  
            <td></td>
            <td></td>
  	      <% else %>  	      	
  	        <td><%= meter["#{m_oil.id}_#{m_code.id}_meter_no"] %></td>
  	        <td><%= meter["#{m_oil.id}_#{m_code.id}_meter"] %></td>
          <% end %> 	        
  	    <% end %>
  	  <% end %>
    </tr>
  <% end %>
</table>	
<br/>

<table id='rounded-corner' class="end_meter" width="1500">
  <tr>
  	<th colspan="2">油種</th>
  	<% @m_oils.each do |m_oil| %>
  	  <th colspan="6"><%= m_oil.oil_name %></th>
  	<% end %>
  </tr>
  <tr>
  	<td rowspan="<%= @meters.size + 1%>">終<br/>了<br/>時<br/>メ<br/>|<br/>タ<br/>|</td>
  	<td>No</td>
  	<% @m_oils.each do |m_oil| %>
  	  <% @m_codes.each do |m_code| %>
  	    <th>計量</th>
  	    <th><%= m_code.code_name %></th>
  	  <% end %> 	
  	<% end %>
  </tr>
  <% @meters.each_with_index do |meter, idx| %>
    <tr>
      <td><%= idx + 1 %></td>	
  	  <% @m_oils.each do |m_oil| %>
  	    <% @m_codes.each do |m_code| %>
  	      <% if meter["#{m_oil.id}_#{m_code.id}_m_meter_id"].blank? %>  
            <td></td>
            <td></td>
  	      <% else %>  	      	
  	        <td><%= meter["#{m_oil.id}_#{m_code.id}_meter_no"] %></td>
  	        <td><%= number_field :meter, meter["#{m_oil.id}_#{m_code.id}_m_meter_id"], :value => meter["#{m_oil.id}_#{m_code.id}_meter"], :size => 4 %></td>
          <% end %> 	        
  	    <% end %>
  	  <% end %>
    </tr>
  <% end %>
</table>
</div>

<div style="float: right;width: 41%;">
<table id='rounded-corner'>
  <tr>
  	<th>タンク</th>
  	<th>容量</th>
  	<th>油種</th>
  	<th>仕入</th>
  	<th>在庫</th>  	  	  	  	
  </tr>
  <% @m_tanks.each do |m_tank| %>
    <tr>
      <th>タンク<%= m_tank.tank_no %></th>
      <th><%= m_tank.volume %>KL</th>
      <th><%= m_tank.oil_name %></th>
      <td><%= number_field :receive, m_tank.m_tank_id, :value => m_tank.receive, :size => 1 %></td>
      <td><%= number_field :stock, m_tank.m_tank_id, :value => m_tank.stock, :size => 1 %></td>                  
    </tr>
  <% end %>
</table>
</div>
  <%= hidden_field :select, :d_result_id, :value => @d_result.id %>
  <div><%= submit_tag '登録' %></div>
<% end %>






<script type="text/javascript">
<!--
function scrollRC()
{
  document.getElementById('trow').scrollLeft
        = document.getElementById('tbody').scrollLeft;
  document.getElementById('tcol').scrollTop
        = document.getElementById('tbody').scrollTop;
}
// -->
</script>
<style type="text/css">
 table{
	border-collapse:collapse;
	white-space:nowrap;
	border:solid 0px;
	padding:0px;
	margin:0px;	
 }
 table th{
    padding: 8px;
	font-weight: normal;
	text-align:center; 
          
	color: #039;
    font-weight:bold;
	background: url('th_001.gif');
    background-repeat:repeat-x;
    border: 1px solid #7D808A;
 }
 
 th.col1,th.col2,
 th.col4,th.col4 {
	background-color: #00ccff;
 }
 th.col1,td.col1,
 th.col2,td.col2 {
 	
	border:solid 1px;
 }
 th.col3,td.col3,
 th.col4,td.col4 {
 	
	border:solid 1px;
	background-color: #00ccff;
 }
 tr.even{
 	background-color: #lightgray;
 }

</style>


<table border="0" cellspacing="0" cellpadding="0" style="width: 400px;">
<!-- HEAD -->
<thead>
  <tr>
    <td>
    	<div style="overflow:hidden;height; 1em; width: 50px;">
			<table width="50">
				<thead>
					<tr>
						<th>油種</th>
					</tr>
					<tr>
						<th>No</th>
					</tr>										
				</thead>
			</table>
		</div>
	</td>
	    <td>
	<div id="trow" style="overflow:hidden; width: 350px;">
			<table style=" width: 415px;">
				<thead>
					<tr>
  	                  <% @m_oils.each do |m_oil| %>
  	                    <th colspan="6"><%= m_oil.oil_name %></th>
  	                  <% end %>					
  	                </tr>
  	                <tr>	
  	                  <% @m_oils.each do |m_oil| %>
  	                    <% @m_codes.each do |m_code| %>
  	                      <th>計量</th>
  	                      <th><%= m_code.code_name %></th>
  	                    <% end %> 	
  	                  <% end %>
  	                </tr>				
				</thead>
			</table>
		</div>
	</td>
  </tr>
</thead>  
<!-- BODY -->
<tbody>
  <tr>
    <td>
    	<div id="tcol" style="overflow: hidden; height: 100px; width;50px;">
			<table style="padding-bottom:15px;">
				<tbody >
  <% @old_meters.each_with_index do |meter, idx| %>
    <tr>
      <td width="50"><%= idx + 1 %></td>	
    </tr>
  <% end %>
 
					<tr style="height:15px;" border="0"></tr>					
				</tbody>
			</table>
		</div>
	</td>
    <td>
    	<div onScroll="scrollRC()" id="tbody" style="overflow:auto; width: 200px; height: 100px;">
			<table style="width: 400px;" >
				<tbody>
  <% @old_meters.each_with_index do |meter| %>
    <tr>
  	  <% @m_oils.each do |m_oil| %>
  	    <% @m_codes.each do |m_code| %>
  	      <% if meter["#{m_oil.id}_#{m_code.id}_m_meter_id"].blank? %>  
            <td class="col4"></td>
            <td class="col4"></td>
  	      <% else %>  	      	
  	        <td class="col4"><%= meter["#{m_oil.id}_#{m_code.id}_meter_no"] %></td>
  	        <td class="col4"><%= meter["#{m_oil.id}_#{m_code.id}_meter"] %></td>
          <% end %> 	        
  	    <% end %>
  	  <% end %>
    </tr>
  <% end %>		
					<tr border="0"></tr>													
				</tbody>
			</table>
		</div>
	</td>
  </tr>
 </tbody>
</table>
